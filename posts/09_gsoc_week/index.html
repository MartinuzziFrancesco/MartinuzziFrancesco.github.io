<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>GSoC week 9: Cycle Reservoirs with Regular Jumps - Francesco Martinuzzi</title><meta name="Description" content="Francesco Martinuzzi"><meta property="og:title" content="GSoC week 9: Cycle Reservoirs with Regular Jumps" />
<meta property="og:description" content="This week body of work is less then the usual amount, since most of my time was spent watching the incredible talks given at JuliaCon 2020. This was my first time attending and I just wanted to spend a few lines congratulating all the speakers for the amazing work they are doing with Julia, and most importantly I wanted to thank the organizers for the fantastic job they did: it really felt like an actual physical conference and the sense of community was truly awesome to experience." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://martinuzzifrancesco.github.io/posts/09_gsoc_week/" />
<meta property="og:image" content="https://martinuzzifrancesco.github.io/logo.png"/>
<meta property="article:published_time" content="2020-08-02T16:45:38+02:00" />
<meta property="article:modified_time" content="2020-08-02T16:45:38+02:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://martinuzzifrancesco.github.io/logo.png"/>

<meta name="twitter:title" content="GSoC week 9: Cycle Reservoirs with Regular Jumps"/>
<meta name="twitter:description" content="This week body of work is less then the usual amount, since most of my time was spent watching the incredible talks given at JuliaCon 2020. This was my first time attending and I just wanted to spend a few lines congratulating all the speakers for the amazing work they are doing with Julia, and most importantly I wanted to thank the organizers for the fantastic job they did: it really felt like an actual physical conference and the sense of community was truly awesome to experience."/>
<meta name="application-name" content="Francesco Martinuzzi">
<meta name="apple-mobile-web-app-title" content="Francesco Martinuzzi"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://martinuzzifrancesco.github.io/posts/09_gsoc_week/" /><link rel="prev" href="https://martinuzzifrancesco.github.io/posts/08_gsoc_week/" /><link rel="next" href="https://martinuzzifrancesco.github.io/posts/10_gsoc_week/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "GSoC week 9: Cycle Reservoirs with Regular Jumps",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/martinuzzifrancesco.github.io\/posts\/09_gsoc_week\/"
        },"image": ["https:\/\/martinuzzifrancesco.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","wordcount":  1448 ,
        "url": "https:\/\/martinuzzifrancesco.github.io\/posts\/09_gsoc_week\/","datePublished": "2020-08-02T16:45:38+02:00","dateModified": "2020-08-02T16:45:38+02:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/martinuzzifrancesco.github.io\/images\/avatar.png",
                    "width":  892 ,
                    "height":  892 
                }},"author": {
                "@type": "Person",
                "name": "Francesco Martinuzzi"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Francesco Martinuzzi">Francesco Martinuzzi</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="What have I done"> Posts </a><a class="menu-item" href="/about/" title="Who am I"> About </a><a class="menu-item" href="/research/" title="What do I do"> Research </a><a class="menu-item" href="/contact/" title="How to reach me"> Contact </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Francesco Martinuzzi">Francesco Martinuzzi</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="What have I done">Posts</a><a class="menu-item" href="/about/" title="Who am I">About</a><a class="menu-item" href="/research/" title="What do I do">Research</a><a class="menu-item" href="/contact/" title="How to reach me">Contact</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">GSoC week 9: Cycle Reservoirs with Regular Jumps</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Francesco Martinuzzi</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2028-82-08">2028-82-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1448 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#implementation-in-reservoircomputing">Implementation in ReservoirComputing</a></li>
  </ul>

  <ul>
    <li><a href="#one-step-ahead-prediction">One step ahead prediction</a></li>
    <li><a href="#attractor-reconstruction">Attractor reconstruction</a></li>
    <li><a href="#documentation">Documentation</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>This week body of work is less then the usual amount, since most of my time was spent watching the incredible talks given at <a href="https://juliacon.org/2020/" target="_blank" rel="noopener noreffer">JuliaCon 2020</a>. This was my first time attending and I just wanted to spend a few lines congratulating all the speakers for the amazing work they are doing with Julia, and most importantly I wanted to thank the organizers for the fantastic job they did: it really felt like an actual physical conference and the sense of community was truly awesome to experience.</p>
<p>In the middle of all the talks I was still able to read a couple of papers and write some code, and this week work is a companion to the work done in <a href="https://martinuzzifrancesco.github.io/posts/06_gsoc_week/" target="_blank" rel="noopener noreffer">week 6</a>: expanding the research done in their previous article <a href="#1" rel="">[1]</a>, they constructed a different type of cycle reservoir with random jumps and a different way to create an input layer <a href="#2" rel="">[2]</a>. In this post we will discuss the theory expressed in the paper and, after explaining the implementation in ReservoirComputing.jl, we will show how this construction performs on the tasks we takled in week 6.</p>
<h1 id="cycle-reservoirs-with-jumps-and-irrational-sign-input-layer">Cycle Reservoirs with Jumps and irrational sign input layer</h1>
<p>The costruction of Cycle Reservoirs with Jumps (CRJ) builds over the idea of the Simple Cycle Reservoir (SCR): contrary to the stadard construction of an Echo State Network (ESN) standard reservoir the two algorithms proposed are completely deterministic and really simple in nature. In the CRJ model the reservoir nodes are connected in a unidirectional cycle, as they are in the SCR model, with bidirectional shortcuts (called jumps). The value for the cycle connections are the same \( r_c &gt; 0 \), and all the jumps also share the same values \( r_j &gt; 0 \). The construction of the CRJ reservoir can be described in the following way:</p>
<ul>
<li>The lower subdiagonal of the reservoir \( \textbf{W} \) is equal to the chosen \( r_c \)</li>
<li>The upper right corner of reservoir \( \textbf{W} \) is equal to the chosen \( r_c \)</li>
<li>With a chosen jump size \( 1 &lt; l &lt; [N/2] \) if \( (N \text{mod}l) = 0 \) then there are \( [N/l] \) jumps, the first being from unit 1 to unit \( 1+l \), the last from unit \( N+1-l \) to unit 1. If \( (N \text{mod}l) \ne 0 \) then there are \( [N/l] \) jumps, the last jump ending in unit \( N+1-(N\text{mod}l) \). All the jumps have the same chosen value \( r_j \)</li>
</ul>
<p>Along with the construction of the CRJ model the paper <a href="#2" rel="">[2]</a> proposes a fully connected input layer with the same absolute value of the connection weight. The sign of the input weights is determined using the decimal expansion of an irrational number, \( \pi \) being the choice of the authors. The first \( N \) digits \( d_1, d_2,&hellip;,d_N \) are taken and if \( 0 \le d_n \le 4 \) then the nth input will have sign - (minus), else if \( 5 \le d_n \le 9 \) it will have a + (plus) sign.</p>
<h2 id="implementation-in-reservoircomputing">Implementation in ReservoirComputing</h2>
<p>A new function called <code>CRJ()</code> has been added to the reservoirs construction; this function takes as input</p>
<ul>
<li><code>res_size</code> the size of the reservior</li>
<li><code>cyrcle_weight</code> the value of the weights \( r_c \)</li>
<li><code>jump_weight</code> the value of the weights \( r_j \)</li>
<li><code>jump_size</code> the number of jumps \( l \)</li>
</ul>
<p>and gives as output a reservoir matrix. In addition a function for the construction of the input layer has also been added. Denominated <code>irrational_sign_input()</code> it takes as input</p>
<ul>
<li><code>res_size</code> the size of the reservior</li>
<li><code>in_size</code> the size of the input vector</li>
<li><code>weight</code> the absolute value of the connection weight</li>
<li><code>irrational</code> an optionl input, with default \( \pi \), used for the determination of the sign for the connection weights</li>
</ul>
<h1 id="example">Example</h1>
<p>To remain in line with the work done in the 6th week, and in order to be able to do a meaningful comparison, we are going to use the <a href="https://en.wikipedia.org/wiki/H%C3%A9non_map" target="_blank" rel="noopener noreffer">Henon map</a> for our tests. The Henon map is defined as</p>
<p>$$x_{x+1} = 1 - ax_n^2 + y_n$$
$$ y_{n+1} = bx_n $$</p>
<p>To obtaine the data for out tests we are going to use DynamicalSystems.jl. Before starting the work let&rsquo;s download and inport all useful packages</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="k">using</span> <span class="n">Pkg</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#34;ReservoirComputing&#34;</span><span class="p">)</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#34;Plots&#34;</span><span class="p">)</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#34;DynamicalSystems&#34;</span><span class="p">)</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#34;LinearAlgebra&#34;</span><span class="p">)</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#34;Random&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="k">using</span> <span class="n">ReservoirComputing</span>
<span class="k">using</span> <span class="n">Plots</span>
<span class="k">using</span> <span class="n">DynamicalSystems</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>
<span class="k">using</span> <span class="n">Random</span>
</code></pre></td></tr></table>
</div>
</div><p>Now we can generate the Henon map, and we will shift the data points by -0.5 and scale them by 2 to reproduce the data we had last time. The initial transient will be washed out and we will create two datasets called <code>train</code> and <code>test</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">henon</span><span class="p">()</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mi">7000</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="kt">Matrix</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span><span class="o">&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">.-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">.*</span> <span class="mi">2</span>
<span class="n">shift</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">train_len</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">predict_len</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">shift</span><span class="o">:</span><span class="n">shift</span><span class="o">+</span><span class="n">train_len</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">shift</span><span class="o">+</span><span class="n">train_len</span><span class="o">:</span><span class="n">shift</span><span class="o">+</span><span class="n">train_len</span><span class="o">+</span><span class="n">predict_len</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>Having the needed data we can proceed to the prediction tasks.</p>
<h2 id="one-step-ahead-prediction">One step ahead prediction</h2>
<p>For sake of comparison we are going to use the same values as last time for the construction of the ESN:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">approx_res_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">sparsity</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">extended_states</span> <span class="o">=</span> <span class="nb">true</span>

<span class="n">input_weight</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">cyrcle_weight</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">jump_weight</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">jumps</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></td></tr></table>
</div>
</div><p>Since this task was not used in the paper <a href="#2" rel="">[2]</a> the new parameters <code>jump_weight</code> and <code>jumps</code> are obtained using a manual grid search and as such are probably not as optimized as the other values. We can proceed to the construction of the ESN with the CRJ reservoir and irrational-determined input layer:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="nd">@time</span> <span class="n">W</span> <span class="o">=</span> <span class="n">CRJ</span><span class="p">(</span><span class="n">approx_res_size</span><span class="p">,</span> <span class="n">cyrcle_weight</span><span class="p">,</span> <span class="n">jump_weight</span><span class="p">,</span> <span class="n">jumps</span><span class="p">)</span>
<span class="n">W_in</span> <span class="o">=</span> <span class="n">irrational_sign_input</span><span class="p">(</span><span class="n">approx_res_size</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">input_weight</span><span class="p">)</span>
<span class="n">esn_crj</span> <span class="o">=</span> <span class="n">ESN</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">W_in</span><span class="p">,</span> <span class="n">extended_states</span> <span class="o">=</span> <span class="n">extended_states</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">0.000053 seconds (6 allocations: 78.359 KiB)
</code></pre></td></tr></table>
</div>
</div><p>Following the procedure we used lst time, in order to test the accuracy of the prediction we are going to use the Normalized Mean Square Error (NMSE), defined as</p>
<p>$$NMSE = \frac{&lt;||\hat{y}(t)-y(t)||^2&gt;}{&lt;||y(t)-&lt;y(t)&gt;||^2&gt;}$$</p>
<p>where</p>
<ul>
<li>\( \hat{y}(t) \) is the readout output</li>
<li>\( y(t) \) is the target output</li>
<li>\( &lt;\cdot&gt; \) indicates the empirical mean</li>
<li>\( ||\cdot|| \) is the Euclidean norm.</li>
</ul>
<p>A simple <code>NMSE</code> function can be created following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="k">function</span> <span class="n">NMSE</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">sums</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">size</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">append!</span><span class="p">(</span><span class="n">sums</span><span class="p">,</span> <span class="n">sum</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">]))</span>
    <span class="k">end</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">size</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">+=</span> <span class="n">norm</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">target</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mf">2.0</span>
        <span class="n">den</span> <span class="o">+=</span> <span class="n">norm</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">sums</span><span class="o">./</span><span class="n">size</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mf">2.0</span>
    <span class="k">end</span>
    <span class="n">nmse</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">size</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">den</span><span class="o">/</span><span class="n">size</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nmse</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>Testing the one step ahead predicting capabilities of this new implementation we obtain:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">wout</span> <span class="o">=</span> <span class="n">ESNtrain</span><span class="p">(</span><span class="n">esn_crj</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ESNpredict_h_steps</span><span class="p">(</span><span class="n">esn_crj</span><span class="p">,</span> <span class="n">predict_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">wout</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="n">NMSE</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">0.0010032069150514866
</code></pre></td></tr></table>
</div>
</div><p>This result outperforms all the architectures tested in week 6, getting a little closer to the standard ESN implementation result. Even though this task is not present in the paper the better results shows that the implementation is valid nevertheless.</p>
<h2 id="attractor-reconstruction">Attractor reconstruction</h2>
<p>Following the work done in week 6 we want to explore the capabilities of this construction in the reconstruction of the chaotic attractor of the Henon map. Using the already built <code>ESN</code> we will predict the system for <code>predict_len</code> steps and at the end we will plot the results to see if they are in line with the one obtained with the other architectures. To refresh our memory we will start by plotting the actual Henon map:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">scatter</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&#34;actual&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://user-images.githubusercontent.com/10376688/87250878-4dda0c80-c468-11ea-8b38-d7071f051363.png"
        data-srcset="https://user-images.githubusercontent.com/10376688/87250878-4dda0c80-c468-11ea-8b38-d7071f051363.png, https://user-images.githubusercontent.com/10376688/87250878-4dda0c80-c468-11ea-8b38-d7071f051363.png 1.5x, https://user-images.githubusercontent.com/10376688/87250878-4dda0c80-c468-11ea-8b38-d7071f051363.png 2x"
        data-sizes="auto"
        alt="https://user-images.githubusercontent.com/10376688/87250878-4dda0c80-c468-11ea-8b38-d7071f051363.png"
        title="actual" /></p>
<p>Let&rsquo;s see if the CRJ-based ESN is capable of reproducing the climate of this attractor:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">wout</span> <span class="o">=</span> <span class="n">ESNtrain</span><span class="p">(</span><span class="n">esn_crj</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ESNpredict</span><span class="p">(</span><span class="n">esn_crj</span><span class="p">,</span> <span class="n">predict_len</span><span class="p">,</span> <span class="n">wout</span><span class="p">)</span>
<span class="n">scatter</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">],</span> <span class="n">lable</span> <span class="o">=</span> <span class="s">&#34;ESN-CRJ&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://user-images.githubusercontent.com/10376688/89126754-852c5e00-d4e8-11ea-9e9f-c4ca21229d44.png"
        data-srcset="https://user-images.githubusercontent.com/10376688/89126754-852c5e00-d4e8-11ea-9e9f-c4ca21229d44.png, https://user-images.githubusercontent.com/10376688/89126754-852c5e00-d4e8-11ea-9e9f-c4ca21229d44.png 1.5x, https://user-images.githubusercontent.com/10376688/89126754-852c5e00-d4e8-11ea-9e9f-c4ca21229d44.png 2x"
        data-sizes="auto"
        alt="https://user-images.githubusercontent.com/10376688/89126754-852c5e00-d4e8-11ea-9e9f-c4ca21229d44.png"
        title="ESN-CRJ" /></p>
<p>The result is actually more clear cut then the results obtained in the 6th week. This architecture seems to be able to represent the attractor in a more precise manner. Both the tests we have done have resulted in a better performance with respect to the other deterministic constructions for reservoirs and input layer. A more statistical accurate exploration is of course needed but both our results and the results found in the paper show the capabilities of this new implementation of a deterministic reservoir.</p>
<p>As always, if you have any questions regarding the model, the package or you have found errors in my post, please don’t hesitate to contact me!</p>
<h2 id="documentation">Documentation</h2>
<p><a id="1">[1]</a>
Rodan, Ali, and Peter Tino. &ldquo;Minimum complexity echo state network.&rdquo; IEEE transactions on neural networks 22.1 (2010): 131-144.</p>
<p><a id="2">[2]</a>
Rodan, Ali, and Peter Tiňo. &ldquo;Simple deterministically constructed cycle reservoirs with regular jumps.&rdquo; Neural computation 24.7 (2012): 1822-1852.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2028-82-08</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/09_gsoc_week/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/08_gsoc_week/" class="prev" rel="prev" title="GSoC week 8: Reservoir Computing with Cellular Automata Part 2"><i class="fas fa-angle-left fa-fw"></i>GSoC week 8: Reservoir Computing with Cellular Automata Part 2</a>
            <a href="/posts/10_gsoc_week/" class="next" rel="next" title="GSoC week 10: Reservoir Memory Machines">GSoC week 10: Reservoir Memory Machines<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Francesco Martinuzzi</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
